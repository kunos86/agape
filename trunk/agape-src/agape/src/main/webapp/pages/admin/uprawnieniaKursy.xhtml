<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:rich="http://richfaces.org/rich"
	template="/themes/standard/template2.xhtml"
	xmlns:a4j="http://richfaces.org/a4j">

	<ui:define name="body">

		<a4j:form>
		<rich:panel>
		<f:facet name="header">
		<h:outputText value="Uprawnienia nauczycieli do kursów" />
		</f:facet>
		
		</rich:panel>

			<rich:extendedDataTable value="#{kursUprawnieniaDataModel}" var="_kurs"
				selection="#{uprawnieniaKursyBrowser.selectedKurs}" 
				noDataLabel="Brak Danych" id="tabela" rows="10" height="300px">
				<a4j:support event="onselectionchange" reRender="tabela1, scroller1" 
					ajaxSingle="true">
				</a4j:support>
				<f:facet name="header">
					<h:outputText value="Dostępne kursy" />
				</f:facet>
				<rich:column title="Nr" label="Nr" sortBy="#{_kurs.nrKursu}">
					<f:facet name="header">
						<h:outputText value="Nr" />
					</f:facet>
					<h:outputText value="#{_kurs.nrKursu}" />

				</rich:column>
				<rich:column title="Tytuł" label="Tytuł" sortBy="#{_kurs.tytul}" filterBy="#{_kurs.tytul}">
					<f:facet name="header">
						<h:outputText value="Tytuł" />
					</f:facet>
					<h:outputText value="#{_kurs.tytul}" />
				</rich:column>
				<rich:column title="Udostępniony" label="Udostępniony">
					<f:facet name="header">
						<h:outputText value="Udostępniony" />
					</f:facet>
					<h:outputText value="#{_kurs.widocznosc ? 'Tak' : 'Nie'}" />
				</rich:column>

				<rich:column title="Data modyfikacji" label="Data modyfikacji">
					<f:facet name="header">
						<h:outputText value="Data modyfikacji" />
					</f:facet>
					<h:outputText value="#{_kurs.dataArch}">
						<f:convertDateTime type="date" pattern="dd.MM.yyyy" />
					</h:outputText>

				</rich:column>
				<f:facet name="footer">
					<rich:datascroller for="tabela" id="scroller" />
				</f:facet>

			</rich:extendedDataTable>
			
		<rich:toolBar id = "buttonPanel" >
			<a4j:commandButton value="Dodaj uprawnieni"
			oncomplete="Richfaces.showModalPanel('popupDodaj')"
			reRender="popupDodaj"/>
			
			
			<a4j:commandButton value="Edytuj osobę" reRender="popup"
					action="#{zarzadzanieOsobami.edycja}"
					oncomplete="Richfaces.showModalPanel('popup')"
					disabled="#{zarzadzanieOsobami.selected == null}">
				</a4j:commandButton>
				
				
		</rich:toolBar>

		<rich:extendedDataTable value="#{uprawnieniaKursNauczDataModel}" var="_naucz"
				selection="#{uprawnieniaKursyBrowser.selectedNauczyciel}" 
				noDataLabel="Brak Danych" id="tabela1" rows="20" height="600px">
				<a4j:support event="onselectionchange" reRender="buttonPanel" 
					ajaxSingle="true">
				</a4j:support>
				<f:facet name="header">
					<h:outputText value="Przypisani nauczyciele" />
				</f:facet>
				<rich:column title="Nazwisko" label="Nazwisko" sortBy="#{_naucz.osoba.nazwisko}">
					<f:facet name="header">
						<h:outputText value="Nazwisko" />
					</f:facet>
					<h:outputText value="#{_naucz.osoba.nazwisko}" />
				</rich:column>
				<rich:column title="Imie" label="Imie" sortBy="#{_naucz.osoba.imie}" filterBy="#{_naucz.osoba.imie}">
					<f:facet name="header">
						<h:outputText value="Imie" />
					</f:facet>
					<h:outputText value="#{_naucz.osoba.imie}" />
				</rich:column>
				
				<f:facet name="footer">
					<rich:datascroller for="tabela1" id="scroller1" />
				</f:facet>

			</rich:extendedDataTable>
			
			
		</a4j:form>
		
		<rich:modalPanel id="popupDodaj" autosized="true" minWidth="300">
			<f:facet name="header">
				<h:outputText value="Dodaj uprawnienie" />
			</f:facet>
			<f:facet name="controls">
					<h:form>
						<a4j:commandButton value="Zamknij"
							onclick="Richfaces.hideModalPanel('popupDodaj')" />
					</h:form>
			</f:facet>
			<h:form>
			<h:panelGrid columns="1">
			<h:outputText value="Wybierz nauczyciela:" />
		
				<h:selectManyListbox value="#{uprawnieniaKursyBrowser.wybraniNauczyciele}">
				<s:selectItems
				value="#{nauczycieleDataList.nauczyciele}" var="_os"
				itemValue="#{_os}" itemLabel="#{_os.nazwisko} #{_os.imie}" label="#{_os.nazwisko} #{_os.imie}" hideNoSelectionLabel="true"
				/>
				<s:convertEntity/>
			</h:selectManyListbox>
			
			</h:panelGrid>
			<h:commandButton id="submit" action="#{uprawnieniaKursyBrowser.dodajUprawnienia()}"
						value="Zapisz" reRender="tabela1"
						oncomplete="if (#{facesContext.maximumSeverity==null}) #{rich:component('popupDodaj')}.hide();"/>
					
			
			</h:form>
		</rich:modalPanel>


		

	</ui:define>
</ui:composition>
